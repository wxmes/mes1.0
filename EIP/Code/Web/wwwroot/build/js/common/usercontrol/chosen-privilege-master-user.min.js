function formSubmit(){var t=$("li[class='selected']",$scrollBar).find("a"),n="";$.each(t,function(t,i){n+='{"u":"'+i.id+'"},'});n=n.substring(0,n.length-1);n="["+n+"]";UtilAjaxPostWait("/UserControl/SavePrivilegeMasterUser",{privilegeMasterUser:n,privilegeMasterValue:$privilegeMasterValue.val(),privilegeMaster:$privilegeMaster.val()},success)}function success(n){DialogAjaxResult(n)&&dialog.close()}function initChosenPrivilegeMasterUserTree(){UtilAjaxPost("/Organization/GetOrganizationTree",{},function(n){$("#chosenPrivilegeMasterUserTree").jstree({core:{data:n,strings:{"Loading ...":"正在加载..."}},plugins:["types","dnd"],types:{"default":{icon:"fa  fa-file-text-o"}}}).bind("activate_node.jstree",function(n,t){searchUserByOrgId(t.node.id)})})}function searchUserByOrgId(n){$("li",$scrollBar).hide();$("[name='"+n+"']").show()}function arrowin(){expand?(chosenPrivilegeMasterUserTreeObj.expandAll(!1),expand=!1,$arrowin.html("展开").attr("class","fa fa-folder-open"),$arrowin.parent().attr("title","展开")):(chosenPrivilegeMasterUserTreeObj.expandAll(!0),expand=!0,$arrowin.html("折叠").attr("class","fa fa-folder"),$arrowin.parent().attr("title","折叠"))}function loadChosenPrivilegeMasterUserTree(){initChosenPrivilegeMasterUserTree();$("li",$scrollBar).show()}function initEvent(){$accessButton.on("click","li",function(){$(this).hasClass("selected")?$(this).attr("class",""):$(this).attr("class","selected")})}function search(){var n=$("#txtKeywords").val().toLocaleLowerCase();n!=""?$("li",$scrollBar).hide():$("li",$scrollBar).show();$("[searchcode*='"+n+"']",$(".scrollBar")).show();$("[searchname*='"+n+"']",$(".scrollBar")).show()}function selectall(){var t=ZtreeGetSelectedNodes($.fn.zTree.getZTreeObj("chosenPrivilegeMasterUserTree")),n=$("li[modelid='"+t[0].id+"']");checkAll?(n.attr("class","selected"),checkAll=!1):(n.attr("class",""),checkAll=!0)}function initUserData(){UtilAjaxPostAsync("/UserControl/GetChosenPrivilegeMasterUser",{privilegeMasterValue:$privilegeMasterValue.val(),privilegeMaster:$privilegeMaster.val()},function(n){$.each(n,function(n,t){var i=t.Exist?"selected":"",r=' <li title="'+t.Code+"-"+t.Name+'" data-toggle="tooltip"  searchcode="'+t.Code+'" searchname="'+t.Name+'" name="'+t.OrganizationId+'" class="'+i+'"><a id="'+t.UserId+'"> '+t.Name+'<\/a><i class="check"><\/i><\/li>';$accessButton.append(r)})})}var chosenPrivilegeMasterUserzNodes,chosenPrivilegeMasterUserTreeObj,chosenPrivilegeMasterUserTreeSetting,$scrollBar,$arrowin,$privilegeMasterValue,$privilegeMaster,$accessButton,expand,checkAll;$(function(){$scrollBar=$(".scrollBar");$arrowin=$("#arrowin");$privilegeMasterValue=$("#privilegeMasterValue");$privilegeMaster=$("#privilegeMaster");$accessButton=$("#accessButton");initUserData();loadChosenPrivilegeMasterUserTree();initEvent()});expand=!1;checkAll=!0;