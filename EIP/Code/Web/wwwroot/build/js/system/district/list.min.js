function initGird(){layui.use("table",function(){tableObj=layui.table;$grid=tableObj.render({elem:"#"+options.table.name,size:"sm",method:"post",url:options.url.get,height:Language.mainHeight,cols:[[{type:"checkbox",fixed:"left",width:30},{title:"序号",type:"numbers",fixed:"left"},{field:"DistrictId",title:"代码",width:"80",sort:!0,fixed:"left"},{field:"Name",title:"名称",width:"80",sort:!0,fixed:"left"},{field:"ShortName",title:"简称",width:"80",sort:!0},{field:"CityCode",title:"城市代码",width:"80",sort:!0},{field:"ZipCode",title:"邮编",sort:!0},{field:"Lng",title:"经度",sort:!0,width:"100"},{field:"Lat",title:"纬度",sort:!0,width:"100"},{field:"PinYin",title:"拼音",sort:!0,width:"80"},{field:"IsFreeze",title:"冻结",width:"80",align:"center",templet:"#templetFreeze",sort:!0},{field:"OrderNo",title:"排序号",sort:!0,width:"80"}]],where:{id:"0"},even:!0,page:!1})})}function initTree(){$tree.jstree({core:{data:function(n,t){var i=n.id;UtilAjaxPostWait("/District/GetDistrictTreeByParentId",{id:i=="#"?"0":i},function(n){t.call(this,n)})}},plugins:["types"],types:{"default":{icon:"fa fa-file-text-o"}}}).bind("activate_node.jstree",function(n,t){pId=t.node.id;getGridData()})}function getGridData(){$grid.reload({where:{id:pId}})}function add(){DialogOpen(options.url.edit,"新增"+options.dialog.title,options.dialog.width)}function edit(){GridIsSelectLayTable(tableObj,options.table.name,function(n){DialogOpen(options.url.edit+"?id="+n[options.table.key],"编辑"+options.dialog.title+"-"+n.Name,options.dialog.width)},!0)}function del(){GridIsSelectLayTableIds(tableObj,options.table.name,options.table.key,function(n){DialogConfirm("此操作为级联删除,将删除对应的子项!删除后不可恢复,确认要删除?",function(){UtilAjaxPostWait(options.url.delete,{id:n},perateStatus)})},!1)}function perateStatus(n){DialogAjaxResult(n);n.ResultSign===0&&reload(!1)}function reload(n){n&&(pId=null);$tree.jstree("destroy");initTree();getGridData()}var options={url:{get:Language.common.apiurl+"/District/GetDistrictByParentId",edit:"/System/District/Edit","delete":"/District/DeleteDistrict"},dialog:{width:610,title:"行政区划"},table:{name:"district-list",key:"DistrictId"}},pId,$grid,$tree,tableObj,height;$(function(){$tree=$("#tree");$tree.height(Language.mainHeight);$tree.slimScroll({height:Language.mainHeight});initTree();initGird()});