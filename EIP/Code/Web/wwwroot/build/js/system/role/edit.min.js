function initForm(){$("#editform").formValidation({message:"请输入有效值",trigger:"blur",fields:{Name:{validators:{notEmpty:{message:"请输入姓名"}}},OrganizationName:{validators:{notEmpty:{message:"请选择归属组织机构"}}}}}).on("success.form.fv",function(){return UtilAjaxPostWait("/Role/SaveRole",$form.form().getFormSimpleData(),function(n){DialogAjaxResult(n)&&(getGridData(),dialog.close())}),!1})}function getById(){var n=$("#RoleId").val();n!=""&&UtilAjaxPostWait("/Role/GetById",{id:n},function(n){$form.form().initFormData(n)})}function initSelect(){UtilAjaxPost("/Organization/GetOrganizationTree",{},function(n){$selectObj.jstree({core:{data:n,strings:{"Loading ...":"正在加载..."}},plugins:["types","dnd","search"],types:{"default":{icon:"fa  fa-file-text-o"}}}).bind("activate_node.jstree",function(n,t){$("#OrganizationId").val(t.node.id);$organizationName.val(t.node.text).focus().blur();hideSelect()})})}function initEvent(){$("#searchValue").on("click",function(){search($("#searchValueKey").val())});$("#searchValueKey").on("keyup",function(){search($(this).val())});$("#menuBtn,#OrganizationName").on("click",function(){showSelect()})}function showSelect(){var i=$organizationName,n=$organizationName.offset(),t=$("#editform").offset();$("#content").css({left:n.left-t.left+"px",top:n.top+i.outerHeight()+2-t.top+"px"}).slideDown("fast");$("body").bind("mousedown",onBodyDown)}function hideSelect(){$("#content").fadeOut("fast");$("body").unbind("mousedown",onBodyDown)}function onBodyDown(n){n.target.id==="menuBtn"||n.target.id==="content"||$(n.target).parents("#content").length>0||hideSelect()}function search(n){$selectObj.jstree(!0).search(n,!0,!0)}function initWith(){$("#input-group").width($organizationName.width()+40)}var $form=$("#editform"),$selectObj,$organizationName;$(function(){initForm();getById()});$selectObj=null;$(document).ready(function(){$selectObj=$("#select-tree");$organizationName=$("#OrganizationName");initSelect();initEvent();setTimeout("initWith()",100)});